description:
  Push and deploy the current version
parameters:
  instance-name:
    type: string
    description: "The instace this version will be deployed to"
  env-name:
    type: string
    description: "The environmant containing this instance"
  image-name:
    type: string
    description: "The environmant containing this instance"
    default: ""
steps:
  - when:
      condition: << parameters.image-name >>
      steps:
        - run:
          name: "Deploy image << parameters.image-name >> to << parameters.instance-name >> on  << parameters.env-name >>"
          command: |
            alto deploy "<< parameters.instance-name >>":"<< parameters.image-name >>" --env "<< parameters.env-name >>" --push --json
  - unless:
      condition: << parameters.image-name >>
      steps:
        - run:
          name: "Deploy to << parameters.instance-name >> on  << parameters.env-name >>"
          command: |
            alto deploy "<< parameters.instance-name >>" --env "<< parameters.env-name >>" --push --json

